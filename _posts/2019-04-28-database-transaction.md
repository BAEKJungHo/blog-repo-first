---
title: "트랜잭션(Transaction)"
layout: post
category: DataBase
tags: [DataBase, MySQL]
excerpt: "데이터베이스의 트랜잭션(Transaction)에 대해 배워 봅시다."
author: BAEKJungHo
---

* content
{:toc}

## Transaction

  트랜잭션(Transaction)이란 데이터베이스의 상태를 변환시키는 논리적 연산의 집합을 의미합니다.
  여러 작업을 하나의 단위로 처리하는것을 의미합니다.

  만약 쇼핑몰에서 물건을 구입할때 상품 주문 테이블에는 정보가 들어가야하고, 회원 테이블에 포인트가 쌓여야합니다.
  이런 작업들은 모두 성공되어야 하며 하나라도 실패시 오류가 발생합니다. 따라서 이런 트랜잭션을 적절하게 처리해주는 것이
  중요합니다.

  - __트랜잭션(Transaction)이 필요한 경우__

  예를들어 계좌이체에서 A가 B의 통장으로 계좌 이체를 할때, 이런 과정은 다음과 같이 이루어 집니다.
  A통장에서 돈을 인출 > B의 통장으로 입금, 하지만 만약 A의 통장에서 돈은 인출 되었는데 B 통장으로 입금하는
  과정에서 문제가 생긴경우 A 통장에서 인출된 돈을 어떻게 처리해야 하는지에 대한 문제가 생깁니다.

  이런 경우 통장 A, B update를 각각 따로 생성하지 않고 `하나의 작업 단위로 묶어` 두 작업이 모두 완벽히 수행
  되어야 양쪽 모두에 결과를 반영할 수 있도록 해주어야 합니다. 트랜잭션은 다음과 같은 상황을 해결해 주어
  `데이터 무결성`을 보장합니다.

### 특징(ACID)

  - 원자성(Atomicity) : 모두 반영되거나 아니면 전혀 반영되지 아니어야 된다. (부분실행안됨)
  트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 합니다.

  - 일관성(Consistency) : 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있게 DB상태로 변환
  시스템이 가지고 있는 고정 요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후에 같아야 합니다.

  - 독립성, 격리성(Isolation) : 둘 이상의 트랜잭션이 동시에 병행 실행되고 있을 때 또 하나의 트랜잭션의 연산이
  끼어들 수 없다. 수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.

  - 영속성, 지속성(Durability) : 트랜잭션의 결과는 영구적으로 반영되어야 한다.

  1. 트랜잭션은 데이터베이스 시스템에서 병행 제어 및 회복 작업 시 처리되는 작업의 논리적 단위이다.
  2. 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 상태 변환 과정의 작업단위이다.
  3. 하나의 트랜잭션은 Commit되거나 Rollback된다.

### 연산

  1. Commit : 한 작업의 논리적 단위가 성공적으로 끝났고, 데이터베이스가 다시 일관된 상태에 있으며 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산
  2. Rollback : 트랜잭션의 실행이 실패하였음을 알리는 연산자로 트랜잭션이 수행한 결과를 원래의 상태로 원상 복귀 시키는 연산

### 상태

  트랜잭션의 상태에는 5가지가 있습니다. 활동, 부분완료-완료, 실패-철회

  1. 활동(Active) : 트랜잭션이 실행 중인 상태
  2. 실패(Fail) : 트랜잭션 실행에 오류가 발생하여 중단된 상태
  3. 철회(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태
  4. 부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태
  5. 완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태
